---
title: "Music trend (1920-2020)"
author: "Tyler Billingsley, Danni Huang, Ted Tranel, Karthik Vasu, Alyssa Whittemore"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
    code_folding: hide

---

<!--
Comments in HTML are like this! 
-->

# Song Energy

The following plot is the distribution of energy songs for a decade from 1920s to 2010s. We observe that prior to the 1960s most of the songs that were realeased had low energy. The curve flattened out in the following two decades and slowing started skewing towadrs high energy. From this trend we can predict that in 2020 there will be more songs with higher energy than lower energy.

```{r message = FALSE,warning=FALSE}
library(tidyverse)
library(plotly)

spotify_data <- read_csv("data.csv")


decade_detect <- function(year) (floor(year/10)*10)

get_density <- function(data) data.frame(density(data$energy)$x,density(data$energy)$y)


df <- spotify_data %>%
        filter(year<2020) %>% 
        mutate(decade=decade_detect(year)) %>%
        group_by(decade) %>% 
        nest() %>%
        mutate(dens = map(data,get_density)) %>% 
        unnest(dens)

ax <- list(title = "Energy (higher value = higher energy)",
           zeroline=FALSE,
           range = c(0,1))
ay <- list(title = "Density")

fig <- df %>%
  plot_ly(
    x = ~df$density.data.energy..x,
    y = ~df$density.data.energy..y,
    type = 'scatter',
    mode = 'lines',
    frame=~df$decade,
    showlegend = FALSE
  )
fig <- fig %>% 
          layout(xaxis = ax, yaxis = ay) %>% 
          animation_slider(
            currentvalue = list(prefix = "Decade ",
                                suffix="s",
                                font = list(color="blue"))
            )
fig
```




# new section


Another section