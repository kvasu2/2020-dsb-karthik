---
title: "Music trend (1920-2020)"
author: "Tyler Billingsley, Danni Huang, Ted Tranel, Karthik Vasu, Alyssa Whittemore"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
    code_folding: hide

---

<!--
Comments in HTML are like this! 
-->

# Song Energy

The following plot is the distribution of energy songs for a decade from 1920s to 2010s. We observe that prior to the 1960s most of the songs that were realeased had low energy. The curve flattened out in the following two decades and slowing started skewing towadrs high energy. From this trend we can predict that in 2020 there will be more songs with higher energy than lower energy.

```{r message = FALSE,warning=FALSE}
library(tidyverse)
library(plotly)

spotify_data <- read_csv("data.csv")


decade_detect <- function(year) (floor(year/10)*10)

get_density <- function(data) data.frame(density(data$energy)$x,density(data$energy)$y)


df <- spotify_data %>%
        filter(year<2020) %>% 
        mutate(decade=decade_detect(year)) %>%
        group_by(decade) %>% 
        nest() %>%
        mutate(dens = map(data,get_density)) %>% 
        unnest(dens)

ax <- list(title = "Energy (higher value = higher energy)",
           zeroline=FALSE,
           range = c(0,1))
ay <- list(title = "Density")

fig <- df %>%
  plot_ly(
    x = ~df$density.data.energy..x,
    y = ~df$density.data.energy..y,
    type = 'scatter',
    mode = 'lines',
    frame=~df$decade,
    showlegend = FALSE
  )
fig <- fig %>% 
          layout(xaxis = ax, yaxis = ay) %>% 
          animation_slider(
            currentvalue = list(prefix = "Decade ",
                                suffix="s",
                                font = list(color="blue"))
            )
fig
```




## Energy vs Popularity

Given that there are more and more song that have high energy a natural assumption to make is that the these songs are more popular than the low energy songs. But this is not the case according to the data. From the following plot we can see that the popularity is constant as the energy varies. This means that lower energy songs are equally as popular as high energy one even though there are a lot of the latter being released released

```{r message = FALSE,warning=FALSE}

df1 <- spotify_data %>% 
        filter(year<2020) %>% 
        mutate(decade=decade_detect(year))

ax <- list(title = "Energy (higher value = higher energy)",
           zeroline=FALSE,
           range = c(0,1))
ay <- list(title = "Popularity")

fig <- df1 %>%
          plot_ly(x = ~df1$energy,
                  y = ~df1$popularity,
                  type = 'scatter',
                  frame=~df1$decade,
                  showlegend = FALSE
                  )

fig <- fig %>% 
          layout(xaxis = ax, yaxis = ay) %>% 
          animation_slider(
            currentvalue = list(prefix = "Decade ",
                                suffix="s",
                                font = list(color="blue"))
            )

fig
```

Remark: We can observe that the average popularity of songs go up as we go through the decades. This is because the popularity refers to current popularity and not when the song was released.
