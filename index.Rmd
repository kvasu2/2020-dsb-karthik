---
title: "Change in music trend from 1920-2020"
author: "My Name, Team mates names"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
    code_folding: hide

---

<!--
Comments in HTML are like this! 
-->

# Song Energy

Write your blog post here.

```{r message = FALSE,warning=FALSE}
library(tidyverse)
library(plotly)

spotify_data <- read_csv("data.csv")


decade_detect <- function(year) (floor(year/10)*10)

get_density <- function(data) data.frame(density(data$energy)$x,density(data$energy)$y)


df <- spotify_data %>%
        filter(year<2020) %>% 
        mutate(decade=decade_detect(year)) %>%
        group_by(decade) %>% 
        nest() %>%
        mutate(dens = map(data,get_density)) %>% 
        unnest(dens)

ax <- list(title = "Energy (higher value = higher energy)",
           zeroline=FALSE,
           range = c(0,1))
ay <- list(title = "Density")

fig <- df %>%
  plot_ly(
    x = ~df$density.data.energy..x,
    y = ~df$density.data.energy..y,
    type = 'scatter',
    mode = 'lines',
    frame=~df$decade,
    showlegend = FALSE
  )
fig <- fig %>% 
          layout(xaxis = ax, yaxis = ay) %>% 
          animation_slider(
            currentvalue = list(prefix = "Decade ",
                                suffix="s",
                                font = list(color="blue"))
            )
fig
```